# Phase 3.1: Client API

**Status:** COMPLETE

## What was implemented

HTTP client, request builder, client options, middleware interface stub.

## Files created

- `Runtime/Core/UHttpClient.cs` — Main client with fluent verb methods (Get, Post, Put, Delete, Patch, Head, Options). SendAsync orchestrates transport + timeline. Thread-safe disposal via Interlocked. Transport ownership: only disposes user-provided transports when DisposeTransport = true.
- `Runtime/Core/UHttpRequestBuilder.cs` — Fluent builder with header methods (WithHeader, WithHeaders preserving multi-value), body methods (WithBody byte[]/string, WithJsonBody string/T/T+options), configuration (WithTimeout, WithMetadata, WithBearerToken, Accept, ContentType). Build() resolves relative URLs, merges headers, applies timeout.
- `Runtime/Core/UHttpClientOptions.cs` — Properties: BaseUrl, DefaultTimeout (30s), DefaultHeaders, Transport, Middlewares, FollowRedirects (true), MaxRedirects (10), DisposeTransport (false). Clone() deep copies with shared Transport/Middleware references.
- `Runtime/Core/IHttpMiddleware.cs` — Interface stub for Phase 4 with InvokeAsync signature and HttpPipelineDelegate delegate.

## Decisions

- ASP.NET Core-style middleware pipeline pattern.
- Redirect following enabled by default (max 10).
- Transport ownership opt-in via DisposeTransport flag.
- Builder merges default + request headers; request headers take precedence.
- System.Text.Json used for WithJsonBody<T> serialization.
